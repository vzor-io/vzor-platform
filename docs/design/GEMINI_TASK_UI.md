# ЗАДАНИЕ ДЛЯ GEMINI: Полный интерфейс VZOR

> **Файл:** `docs/design/GEMINI_TASK_UI.md`
> **Дата:** 2026-02-03
> **ВАЖНО:** Следуй инструкциям ТОЧНО. Не импровизируй.

---

## СТРУКТУРА ИНТЕРФЕЙСА

```
┌──┬─────────────────┬────────────────────────────┬──────────────┐
│И │                 │                            │              │
│К │  ЛЕВАЯ ПАНЕЛЬ   │      ЦЕНТР                 │   ПРАВАЯ     │
│О │  (список задач) │      (3D граф)             │   ПАНЕЛЬ     │
│Н │                 │                            │   (детали)   │
│К │                 │                            │              │
│И │                 │                            │              │
├──┴─────────────────┴────────────────────────────┴──────────────┤
│                     NODE EDITOR (скрыт по умолчанию)           │
├────────────────────────────────────────────────────────────────┤
│  [🎤 Голосовой ввод...]                         [⚙️ Ноды]     │
└────────────────────────────────────────────────────────────────┘
```

---

## ЧАСТЬ 1: ЛЕВАЯ ПАНЕЛЬ ИКОНОК

### Размеры:
- Ширина: **48px** (фиксированная)
- Высота: **100%** экрана
- Фон: `#1a1a2e` (тёмно-синий)

### Иконки (сверху вниз):
```
📊  Инвест-анализ     (hover: "Инвест-анализ")
📐  Проектирование    (hover: "Проектирование")
🏗️  Строительство     (hover: "Строительство")
💰  Продажи           (hover: "Продажи")
───  разделитель
📁  Файлы проекта     (hover: "Документы")
⚙️  Настройки         (hover: "Настройки")
```

### Поведение:
1. **Клик на иконку** → открывается ЛЕВАЯ ПАНЕЛЬ со списком задач
2. **Повторный клик на ту же иконку** → закрывается ЛЕВАЯ ПАНЕЛЬ
3. **Клик на другую иконку** → переключается содержимое ЛЕВОЙ ПАНЕЛИ
4. **Активная иконка** → подсветка слева (полоска 3px, цвет `#4ECDC4`)

### CSS:
```css
.icon-bar {
    width: 48px;
    background: #1a1a2e;
    display: flex;
    flex-direction: column;
    padding: 8px 0;
}

.icon-button {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background 0.15s;
}

.icon-button:hover {
    background: rgba(255, 255, 255, 0.1);
}

.icon-button.active {
    border-left: 3px solid #4ECDC4;
}
```

---

## ЧАСТЬ 2: ЛЕВАЯ ПАНЕЛЬ (СПИСОК ЗАДАЧ)

### Размеры:
- Ширина: **280px**
- Высота: **100%**
- Фон: `#16213e`
- Появляется СПРАВА от панели иконок

### Анимация появления:
```css
.left-panel {
    width: 0;
    overflow: hidden;
    transition: width 0.2s ease-out;
}

.left-panel.open {
    width: 280px;
}
```

### Структура содержимого:
```
┌─────────────────────────────────┐
│ ИНВЕСТ-АНАЛИЗ              [×] │  ← заголовок
├─────────────────────────────────┤
│                                 │
│ ✓ Градостроительный анализ     │  ← задача (готово)
│ ✓ Анализ локации               │  ← задача (готово)
│ ⟳ ТЭО                    65%   │  ← задача (выполняется)
│ ○ Финансовая модель            │  ← задача (ожидает)
│ ○ Инвест. заключение           │  ← задача (ожидает)
│                                 │
└─────────────────────────────────┘
```

### Иконки статусов:
- `✓` (зелёный #32CD32) — готово
- `⟳` (синий #4ECDC4, анимация вращения) — выполняется
- `○` (серый #666) — ожидает
- `✗` (красный #FF6B6B) — ошибка

### Поведение:
1. **Клик на задачу** → выделяется точка в 3D графе + открывается ПРАВАЯ ПАНЕЛЬ
2. **[×]** → закрывает ЛЕВУЮ ПАНЕЛЬ

---

## ЧАСТЬ 3: ЦЕНТР (3D ГРАФ)

### Размеры:
- Занимает ВСЁ оставшееся пространство
- Фон: градиент `#0f0f23` → `#1a1a2e`

### Точки (задачи):
- Размер: **12px** (обычная), **16px** (выделенная)
- Форма: круг

### Цвета точек по блокам:
- Инвест-анализ: `#3498db` (синий)
- Проектирование: `#2ecc71` (зелёный)
- Строительство: `#f39c12` (оранжевый)
- Продажи: `#e74c3c` (красный)

### Цвета по статусам (обводка):
- pending: нет обводки
- running: белая обводка + пульсация
- done: без изменений
- error: красная обводка

### Поведение:
1. **Наведение на точку** → увеличение до 16px + tooltip
2. **Клик на точку** → выделение + открывается ПРАВАЯ ПАНЕЛЬ
3. **Выделенная точка** → белая обводка 2px

### Tooltip при наведении:
```
┌─────────────────────────┐
│ Градостр. анализ        │
│ Статус: ✓ Готово        │
└─────────────────────────┘
```
- Фон: `#1a1a2e`
- Рамка: 1px `#333`
- Появляется через 300ms

### Линии связей:
- Цвет: `rgba(255, 255, 255, 0.3)`
- Толщина: 1px
- При выделении задачи: связанные линии → `rgba(255, 255, 255, 0.8)`

---

## ЧАСТЬ 4: ПРАВАЯ ПАНЕЛЬ (ДЕТАЛИ ЗАДАЧИ)

### Размеры:
- Ширина: **320px**
- Высота: **100%**
- Фон: `#16213e`

### Анимация:
```css
.right-panel {
    width: 0;
    overflow: hidden;
    transition: width 0.2s ease-out;
}

.right-panel.open {
    width: 320px;
}
```

### Структура:
```
┌─────────────────────────────────┐
│ Градостроительный анализ   [×] │  ← заголовок + закрыть
├─────────────────────────────────┤
│ Статус: ✓ Готово               │
│ Время: 2м 34с                  │
│ Агент: Analyst (DeepSeek)      │
├─────────────────────────────────┤
│ РЕЗУЛЬТАТЫ                     │
│ 📄 Отчёт.pdf            [👁]   │  ← просмотр
│ 📊 Данные.xlsx          [⬇]   │  ← скачать
├─────────────────────────────────┤
│ ДАННЫЕ                         │
│ Этажность: 25                  │
│ Плотность: 25000 м²/га         │
│ Ограничения: ...               │
├─────────────────────────────────┤
│ СВЯЗИ                          │
│ ← Входные данные (нет)         │
│ → Анализ локации               │
│ → ТЭО                          │
└─────────────────────────────────┘
```

### Поведение:
1. **Открывается** при клике на точку или задачу в списке
2. **[×]** → закрывает панель
3. **Клик вне панели** → закрывает панель

---

## ЧАСТЬ 5: NODE EDITOR (НИЖНЯЯ ПАНЕЛЬ)

### ВАЖНО: Скрыт по умолчанию!

### Размеры:
- Высота: **300px** (по умолчанию)
- Ширина: **100%**
- Можно изменять высоту перетаскиванием верхней границы
- Минимум: 200px, Максимум: 50% экрана

### Как открыть:
- Кнопка **[⚙️ Ноды]** внизу экрана
- Повторный клик → закрыть

### Анимация:
```css
.node-editor {
    height: 0;
    overflow: hidden;
    transition: height 0.2s ease-out;
}

.node-editor.open {
    height: 300px;
}
```

### Внутри — ReactFlow:
- Фон: `#0f0f23`
- Сетка: точки, цвет `#333`, шаг 20px

---

## ЧАСТЬ 6: КОМПОНЕНТ НОДЫ (TaskNode)

### КРИТИЧЕСКИ ВАЖНО — РАЗМЕРЫ:

```
Ширина: 220px (фиксированная)
Высота: автоматическая (по содержимому)
Минимум: 120px
```

### Структура ноды (УПРОЩЁННАЯ):

```
┌──────────────────────────────────┐
│ ● Градостр. анализ          [▼] │  ← заголовок
├──────────────────────────────────┤
│ Агент: Analyst                   │
│ Статус: ✓ Готово                │
├──────────────────────────────────┤
│ ●───────────────────────────● │  ← входы/выходы
└──────────────────────────────────┘
```

### НЕ ДЕЛАТЬ:
- ❌ Огромные ноды на весь экран
- ❌ Много текста внутри
- ❌ Сложные внутренние элементы
- ❌ Статичные картинки

### ДЕЛАТЬ:
- ✅ Компактные ноды 220px шириной
- ✅ Перетаскивание мышкой
- ✅ Соединение проводами
- ✅ Zoom и Pan (колёсико мыши)

### CSS ноды:
```css
.task-node {
    width: 220px;
    background: #1a1a2e;
    border: 2px solid #333;
    border-radius: 8px;
    font-size: 12px;
}

.task-node.selected {
    border-color: #4ECDC4;
    box-shadow: 0 0 10px rgba(78, 205, 196, 0.3);
}

.task-node.running {
    border-color: #3498db;
    animation: pulse 1.5s infinite;
}

.task-node.done {
    border-color: #32CD32;
}

.task-node.error {
    border-color: #FF6B6B;
}

@keyframes pulse {
    0%, 100% { box-shadow: 0 0 5px rgba(52, 152, 219, 0.5); }
    50% { box-shadow: 0 0 15px rgba(52, 152, 219, 0.8); }
}
```

### Handles (точки подключения):
- Слева: 1 вход (● жёлтый #FFD700)
- Справа: 1 выход (● зелёный #32CD32)
- Размер: 10px

---

## ЧАСТЬ 7: НИЖНЯЯ ПАНЕЛЬ (ЧАТ)

### Размеры:
- Высота: **56px**
- Ширина: **100%**
- Фон: `#1a1a2e`

### Структура:
```
┌────────────────────────────────────────────────────────────────┐
│  [🎤] Голосовой ввод активен...              [⚙️ Ноды]        │
└────────────────────────────────────────────────────────────────┘
```

### Элементы:
1. **[🎤]** — кнопка микрофона (toggle)
2. **Текст статуса** — "Слушаю...", "Голосовой ввод активен..."
3. **[⚙️ Ноды]** — кнопка открытия Node Editor

---

## ПОРЯДОК РЕАЛИЗАЦИИ

### Шаг 1: Базовый Layout
```
┌──┬───────────────────────────────────────────┐
│И │                                           │
│К │              ЦЕНТР                        │
│О │           (заглушка)                      │
│Н │                                           │
│К │                                           │
│И │                                           │
├──┴───────────────────────────────────────────┤
│              НИЖНЯЯ ПАНЕЛЬ                   │
└──────────────────────────────────────────────┘
```

### Шаг 2: Левая панель
- Добавить открытие/закрытие по клику на иконки

### Шаг 3: Правая панель
- Добавить открытие/закрытие

### Шаг 4: 3D Граф (упрощённый)
- Можно начать с 2D canvas, потом перейти на Three.js
- Точки + линии + клики

### Шаг 5: Node Editor
- ReactFlow с компактными нодами
- Перетаскивание, соединения

### Шаг 6: Синхронизация
- Клик в любом месте → обновляется везде

---

## ТЕСТОВЫЕ ДАННЫЕ

```typescript
const testTasks = [
    {
        id: '1',
        name: 'Градостроительный анализ',
        block: 'invest',
        status: 'done',
        progress: 100,
        position2D: { x: 100, y: 100 },
        position3D: [0, 0, 0],
    },
    {
        id: '2',
        name: 'Анализ локации',
        block: 'invest',
        status: 'done',
        progress: 100,
        position2D: { x: 350, y: 100 },
        position3D: [1, 0, 0],
    },
    {
        id: '3',
        name: 'ТЭО',
        block: 'invest',
        status: 'running',
        progress: 65,
        position2D: { x: 600, y: 100 },
        position3D: [2, 0, 0],
    },
    {
        id: '4',
        name: 'Финансовая модель',
        block: 'invest',
        status: 'pending',
        progress: 0,
        position2D: { x: 850, y: 100 },
        position3D: [3, 0, 0],
    },
];

const testConnections = [
    { id: 'c1', sourceId: '1', targetId: '2' },
    { id: 'c2', sourceId: '2', targetId: '3' },
    { id: 'c3', sourceId: '3', targetId: '4' },
];
```

---

## КРИТЕРИИ ГОТОВНОСТИ

### Обязательно:
- [ ] Левая панель иконок работает (клик → открыть/закрыть)
- [ ] Левая панель со списком задач
- [ ] Правая панель с деталями задачи
- [ ] 3D граф с точками (хотя бы 2D версия)
- [ ] Клик на точку → открывается правая панель
- [ ] Клик на задачу в списке → выделяется точка
- [ ] Node Editor открывается по кнопке
- [ ] Ноды КОМПАКТНЫЕ (220px), перетаскиваются
- [ ] Ноды соединяются линиями

### Желательно:
- [ ] Hover preview на точках
- [ ] Анимация пульсации для running
- [ ] Изменение размера Node Editor перетаскиванием

---

## ЧЕГО НЕ ДЕЛАТЬ

1. ❌ Огромные ноды на весь экран
2. ❌ Статичные картинки вместо интерактива
3. ❌ Сложный UI с кучей кнопок
4. ❌ Игнорировать размеры из спецификации
5. ❌ Делать "по-своему"

---

*Создано для Gemini Pro. Следуй ТОЧНО.*
